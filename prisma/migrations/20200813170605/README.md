# Migration `20200813170605`

This migration has been generated by Alexander Swed at 8/13/2020, 7:06:05 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "new_Timetable" (
"id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
"teacherId" INTEGER NOT NULL,
FOREIGN KEY ("teacherId") REFERENCES "Teacher"("userId") ON DELETE CASCADE ON UPDATE CASCADE
)

INSERT INTO "new_Timetable" ("id") SELECT "id" FROM "Timetable"

PRAGMA foreign_keys=off;
DROP TABLE "Timetable";;
PRAGMA foreign_keys=on

ALTER TABLE "new_Timetable" RENAME TO "Timetable";

CREATE TABLE "new_Teacher" (
"userId" INTEGER NOT NULL,
PRIMARY KEY ("userId"),
FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

INSERT INTO "new_Teacher" ("userId") SELECT "userId" FROM "Teacher"

PRAGMA foreign_keys=off;
DROP TABLE "Teacher";;
PRAGMA foreign_keys=on

ALTER TABLE "new_Teacher" RENAME TO "Teacher";

CREATE UNIQUE INDEX "Teacher_userId" ON "Teacher"("userId")

PRAGMA foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200801125642..20200813170605
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
     provider = "sqlite"
-    url = "***"
+    url = "***"
 }
 generator client {
     provider = "prisma-client-js"
@@ -21,11 +21,12 @@
     teacher        Teacher?
 }
 model Teacher {
-    userId  Int             @id
-    user    User            @relation(fields: [userId], references: [id])
-    classes TechingCourse[]
+    userId     Int             @id
+    user       User            @relation(fields: [userId], references: [id])
+    classes    TechingCourse[]
+    timetables Timetable[]
 }
 model TechingCourse {
     id         Int                   @id @default(autoincrement())
@@ -47,10 +48,12 @@
     techingCourse TechingCourse[]
 }
 model Timetable {
-    id      Int      @id @default(autoincrement())
-    periods Period[]
+    id        Int      @id @default(autoincrement())
+    periods   Period[]
+    creator   Teacher  @relation(fields: [teacherId], references: [userId])
+    teacherId Int
 }
 model TechingCourseSchedule {
     id        Int           @id @default(autoincrement())
```


