# Migration `20200722210934`

This migration has been generated by Alexander Swed at 7/22/2020, 9:09:34 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "new_Teacher" (
"userId" INTEGER NOT NULL,
PRIMARY KEY ("userId"),
FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

INSERT INTO "new_Teacher" ("userId") SELECT "userId" FROM "Teacher"

PRAGMA foreign_keys=off;
DROP TABLE "Teacher";;
PRAGMA foreign_keys=on

ALTER TABLE "new_Teacher" RENAME TO "Teacher";

CREATE UNIQUE INDEX "Teacher_userId" ON "Teacher"("userId")

CREATE TABLE "new_TechingCourseSchedule" (
"id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
"startDate" DATE ,
"endDate" DATE ,
"day" INTEGER ,
"periodId" INTEGER ,
FOREIGN KEY ("periodId") REFERENCES "Period"("id") ON DELETE SET NULL ON UPDATE CASCADE
)

INSERT INTO "new_TechingCourseSchedule" ("day", "endDate", "id", "periodId", "startDate") SELECT "day", "endDate", "id", "periodId", "startDate" FROM "TechingCourseSchedule"

PRAGMA foreign_keys=off;
DROP TABLE "TechingCourseSchedule";;
PRAGMA foreign_keys=on

ALTER TABLE "new_TechingCourseSchedule" RENAME TO "TechingCourseSchedule";

PRAGMA foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200722204057..20200722210934
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
     provider = "sqlite"
-    url = "***"
+    url = "***"
 }
 generator client {
     provider = "prisma-client-js"
@@ -53,11 +53,11 @@
     /// beginning of the course
     startDate DateTime?
     /// end of the course
     endDate   DateTime?
-    day       Int
-    period    Period        @relation(fields: [periodId], references: [id])
-    periodId  Int
+    day       Int?
+    period    Period?       @relation(fields: [periodId], references: [id])
+    periodId  Int?
 }
 model Lesson {
     id              Int            @id @default(autoincrement())
```


