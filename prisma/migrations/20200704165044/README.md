# Migration `20200704165044`

This migration has been generated by Alexander Swed at 7/4/2020, 4:50:44 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."UserDetails" (
"alias" TEXT   ,"avatarUrl" TEXT   ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"name" TEXT   ,"phoneNumber" TEXT   )

CREATE TABLE "quaint"."new_User" (
"detailsId" INTEGER NOT NULL  ,"disabled" BOOLEAN  DEFAULT false ,"email" TEXT NOT NULL  ,"emailConfirmed" BOOLEAN NOT NULL DEFAULT false ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"lastActivityAt" DATE   ,"registeredAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,FOREIGN KEY ("detailsId") REFERENCES "UserDetails"("id") ON DELETE CASCADE ON UPDATE CASCADE)

INSERT INTO "quaint"."new_User" ("disabled", "email", "id", "lastActivityAt", "registeredAt") SELECT "disabled", "email", "id", "lastActivityAt", "registeredAt" FROM "quaint"."User"

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."User";;
PRAGMA foreign_keys=on

ALTER TABLE "quaint"."new_User" RENAME TO "User";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200704140647..20200704165044
--- datamodel.dml
+++ datamodel.dml
@@ -1,20 +1,29 @@
 datasource db {
     provider = "sqlite"
-    url = "***"
+    url = "***"
 }
 generator client {
     provider = "prisma-client-js"
 }
 // internal info
 model User {
-    id             Int       @default(autoincrement()) @id
+    id             Int         @default(autoincrement()) @id
+    detailsId      Int
+    details        UserDetails @relation(fields: [detailsId], references: [id])
     email          String
-    name           String?
-    alias          String?
-    phoneNumber    String?
-    disabled       Boolean?
-    registeredAt   DateTime
+    emailConfirmed Boolean     @default(false)
+    disabled       Boolean?    @default(false)
+    registeredAt   DateTime    @default(now())
     lastActivityAt DateTime?
 }
+
+model UserDetails {
+    id          Int     @default(autoincrement()) @id
+    name        String?
+    alias       String?
+    phoneNumber String?
+    avatarUrl   String?
+    User        User[]
+}
```


